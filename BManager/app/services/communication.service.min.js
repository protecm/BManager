"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var webserver_constants_1=require("../constants/webserver.constants"),communication_constants_1=require("../constants/communication.constants"),server_message_object_1=require("../objects/server.message.object"),CommunicationService=function(){function CommunicationService($http,authenticationService,base64,$state,$location){this.$http=$http,this.authenticationService=authenticationService,this.base64=base64,this.$state=$state,this.$location=$location}return CommunicationService.prototype.sendRequest=function(url,obj,timeout){var _this=this;url=this.processUrl(url);var transferData=obj.serialize(this.base64),credentials=this.authenticationService.credentials?this.authenticationService.credentials.serialize(this.base64):"";return this.$http({method:"POST",url:url,timeout:timeout,data:{reqData:transferData,credentials:credentials}}).then(function(response){return response.data.code===communication_constants_1.CommunicationConstants.CODE_AUTHENTICATION_FAILED&&_this.$state.go("login"),response.data},function(error){return new server_message_object_1.ServerMessageObject(communication_constants_1.CommunicationConstants.CODE_NOT_OK,"Communication error")})},CommunicationService.prototype.processUrl=function(url){return this.$location.port()===webserver_constants_1.WebserverConstants.DEBUG_PORT||webserver_constants_1.WebserverConstants.REDIRECT_ON?[webserver_constants_1.WebserverConstants.SCHEME,"://",webserver_constants_1.WebserverConstants.HOSTNAME,":",webserver_constants_1.WebserverConstants.PORT,webserver_constants_1.WebserverConstants.ROOT_PATH,url].join(""):[webserver_constants_1.WebserverConstants.ROOT_PATH,url].join("")},CommunicationService}();exports.CommunicationService=CommunicationService;