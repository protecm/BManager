"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var user_object_1=require("../objects/user/user.object"),router_state_constants_1=require("../constants/router.state.constants"),access_level_constants_1=require("../constants/access.level.constants"),LoginComponent=function(){function LoginComponent(loginService,confService,permService,modalService,$translate,$state){this.loginService=loginService,this.confService=confService,this.permService=permService,this.modalService=modalService,this.$translate=$translate,this.$state=$state}return LoginComponent.prototype.login=function(){var _this=this;this.isLoginInProcess=!0;var user=new user_object_1.UserObject(null,this.username,this.password,null,!1);this.loginService.login(user).then(function(status){status?_this.loadConfigurationFromServer():(_this.isLoginInProcess=!1,_this.showLoginErrorMessage())})},LoginComponent.prototype.loadConfigurationFromServer=function(){var _this=this;this.confService.loadConfiguration().then(function(status){_this.isLoginInProcess=!1,status&&_this.redirectToHomeView()})},LoginComponent.prototype.redirectToHomeView=function(){for(var homeState,states=router_state_constants_1.RouterStateConstants.STATES,i=0;i<states.length;i++){var state=states[i];if(this.permService.userHasPermission(state.permission,access_level_constants_1.AccessLevelConstants.ACCESS_VIEW)){homeState=state;break}}homeState?this.$state.go(homeState.name):this.$state.go("emptyHome")},LoginComponent.prototype.showLoginErrorMessage=function(){var title=this.$translate.instant("LOGIN_FAILED"),msg=this.$translate.instant("USER_OR_PASSWORD_INCORRECT");this.modalService.showErrorMessage(title,msg)},LoginComponent}();exports.loginComponent={controller:LoginComponent,controllerAs:"vm",templateUrl:"app/templates/login.template.html"};