"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var customer_add_modal_component_1=require("./modals/customer/customer.add.modal.component"),customer_edit_modal_component_1=require("./modals/customer/customer.edit.modal.component"),db_messages_constants_1=require("../constants/db.messages.constants"),customer_filter_object_1=require("../objects/customer/customer.filter.object"),CustomersComponent=function(){function CustomersComponent(modalService,customerService,confirmationService,$translate,toastService){var _this=this;this.modalService=modalService,this.customerService=customerService,this.confirmationService=confirmationService,this.$translate=$translate,this.toastService=toastService,this.deleteCustomerRequest=function(customer){var title=_this.$translate.instant("DELETE_CUSTOMER"),bodyMsg=_this.confirmationService.getDefaultBodyTemplate(_this.$translate.instant("CONFIRM_DELETE_CUSTOMER"),customer.name);return _this.confirmationService.confirm(title,bodyMsg).then(function(result){if(result)return _this.deleteCustomer(customer)},function(error){})},this.editCustomer=function(customer){var options=new customer_edit_modal_component_1.customerEditModalComponent(customer);return _this.modalService.showModal(options).then(function(data){data&&_this.updateCustomer(customer,data)},function(error){})},this.getCustomersFromServer()}return CustomersComponent.prototype.createCustomer=function(){var _this=this,options=new customer_add_modal_component_1.customerAddModalComponent;this.modalService.showModal(options).then(function(data){data&&(_this.addCustomer(data),_this.toastService.showSuccess("CREATED_SUCCESSFULLY","CUSTOMER"))},function(error){})},CustomersComponent.prototype.deleteCustomer=function(customer){var _this=this;return this.customerService.deleteCustomer(customer).then(function(dbMsg){dbMsg.code===db_messages_constants_1.DbMessagesConstants.CODE_OK&&(customer.isDeleted=!0,_this.removeCustomer(customer),_this.toastService.showSuccess("DELETED_SUCCESSFULLY","CUSTOMER"))})},CustomersComponent.prototype.getCustomersFromServer=function(){var _this=this;this.customerService.getCustomers(customer_filter_object_1.CustomerFilterObject.GetActiveCustomersFilter()).then(function(data){_this.customers=data})},CustomersComponent.prototype.addCustomer=function(customer){this.customers.push(customer)},CustomersComponent.prototype.updateCustomer=function(orgCustomer,edtCustomer){for(var len=this.customers.length,i=0;i<len;i++)if(this.customers[i].id===orgCustomer.id){this.customers[i]=edtCustomer;break}},CustomersComponent.prototype.removeCustomer=function(customer){for(var len=this.customers.length,i=0;i<len;i++)if(this.customers[i].id===customer.id){this.customers.splice(i,1);break}},CustomersComponent}();exports.customersComponent={controller:CustomersComponent,controllerAs:"vm",templateUrl:"app/templates/customers.template.html"};