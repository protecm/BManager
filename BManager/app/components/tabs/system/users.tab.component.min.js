"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var user_edit_modal_component_1=require("../../modals/user/user.edit.modal.component"),db_messages_constants_1=require("../../../constants/db.messages.constants"),user_filter_object_1=require("../../../objects/user/user.filter.object"),user_add_modal_component_1=require("../../modals/user/user.add.modal.component"),UsersTabComponent=function(){function UsersTabComponent(usersService,confirmationService,$translate,modalService,toastService){this.usersService=usersService,this.confirmationService=confirmationService,this.$translate=$translate,this.modalService=modalService,this.toastService=toastService,this.isDeleteInProcess={};var activeUsersFilter=user_filter_object_1.UserFilterObject.GetActiveUsersFilter();this.getUsersFromServer(activeUsersFilter)}return UsersTabComponent.prototype.createUser=function(){var _this=this,options=new user_add_modal_component_1.userAddModalComponent;this.modalService.showModal(options).then(function(data){data&&(_this.addUser(data),_this.toastService.showSuccess("CREATED_SUCCESSFULLY","USER"))},function(error){})},UsersTabComponent.prototype.editUser=function(user){var _this=this,options=new user_edit_modal_component_1.userEditModalComponent(user);this.modalService.showModal(options).then(function(data){data&&_this.updateUser(user,data)},function(error){})},UsersTabComponent.prototype.addUser=function(user){this.users.push(user)},UsersTabComponent.prototype.updateUser=function(orgUser,edtUser){for(var len=this.users.length,i=0;i<len;i++)if(this.users[i].id===orgUser.id){this.users[i]=edtUser;break}},UsersTabComponent.prototype.deleteUserRequest=function(user){var _this=this,title=this.$translate.instant("DELETE_USER"),bodyMsg=this.confirmationService.getDefaultBodyTemplate(this.$translate.instant("CONFIRM_DELETE_USER"),user.username);this.confirmationService.confirm(title,bodyMsg).then(function(result){result&&_this.deleteUser(user)},function(error){})},UsersTabComponent.prototype.deleteUser=function(user){var _this=this;this.isDeleteInProcess[user.id]=!0,this.usersService.deleteUser(user).then(function(dbMsg){dbMsg.code===db_messages_constants_1.DbMessagesConstants.CODE_OK&&(user.isDeleted=!0,_this.removeUser(user),_this.toastService.showSuccess("DELETED_SUCCESSFULLY","USER")),_this.isDeleteInProcess[user.id]=!1})},UsersTabComponent.prototype.removeUser=function(user){for(var len=this.users.length,i=0;i<len;i++)if(this.users[i].id===user.id){this.users.splice(i,1);break}},UsersTabComponent.prototype.getUsersFromServer=function(filter){var _this=this;this.usersService.getUsers(filter).then(function(data){_this.users=data})},UsersTabComponent}();exports.usersTabComponent={controller:UsersTabComponent,controllerAs:"vm",templateUrl:"app/templates/tabs/users.tab.template.html"};